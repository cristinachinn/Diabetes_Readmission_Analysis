SELECT
  diag_1 AS primary_diagnosis,
  COUNT(*) AS total_cases,
  SUM(CASE WHEN days_until_readmission = '<30' THEN 1 ELSE 0 END) AS read_lessthan30
FROM `diabetic-473818.diabetic.diabetic-473818`
GROUP BY primary_diagnosis
ORDER BY total_cases DESC
LIMIT 10;