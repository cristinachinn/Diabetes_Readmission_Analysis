SELECT
  time_in_hospital AS days_in_hospital,
  COUNT(*) AS total_patients,
  ROUND(SUM(CASE WHEN days_until_readmission = '<30' THEN 1 ELSE 0 END) * 100.0 / COUNT(*), 2) AS pct_readmitted
FROM `diabetic-473818.diabetic.diabetic-473818`
GROUP BY time_in_hospital
ORDER BY time_in_hospital ASC;
